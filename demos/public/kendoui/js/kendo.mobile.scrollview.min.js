/*
* Kendo UI Complete v2013.3.1030 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
!function(define){return define(["./kendo.mobile.application.min"],function(){!function(e,t){var i,n,s,a,o,h,r,c,p=window.kendo,g=p.mobile,d=g.ui,l=e.proxy,u=p.effects.Transition,f=p.ui.Pane,m=p.ui.PaneDimensions,_=d.Widget,v=p.data.DataSource,w=p.data.Buffer,P=p.data.BatchBuffer,b=Math,y=b.abs,x=b.ceil,T=b.round,S=b.max,C=b.min,z=b.floor,E="change",R="changing",O="refresh",V="km-current-page",W="km-virtual-page",k="function",D="itemChange",B=3,M=-1,H=0,U=1,A=-1,I=0,q=1,F=p.Class.extend({init:function(t){var i=this,n=e("<ol class='km-pages'/>");t.element.append(n),this._changeProxy=l(i,"_change"),this._refreshProxy=l(i,"_refresh"),t.bind(E,this._changeProxy),t.bind(O,this._refreshProxy),e.extend(i,{element:n,scrollView:t})},items:function(){return this.element.children()},_refresh:function(e){var t,i="";for(t=0;t<e.pageCount;t++)i+="<li/>";this.element.html(i),this.items().eq(e.page).addClass(V)},_change:function(e){this.items().removeClass(V).eq(e.page).addClass(V)},destroy:function(){this.scrollView.unbind(E,this._changeProxy),this.scrollView.unbind(O,this._refreshProxy),this.element.remove()}});p.mobile.ui.ScrollViewPager=F,i="transitionEnd",n="dragStart",s="dragEnd",a=p.Observable.extend({init:function(t,a){var o,h,r,c,g,d,l=this;p.Observable.fn.init.call(this),this.element=t,this.container=t.parent(),o=new p.ui.Movable(l.element),h=new u({axis:"x",movable:o,onEnd:function(){l.trigger(i)}}),r=new p.UserEvents(t,{start:function(e){2*y(e.x.velocity)>=y(e.y.velocity)?r.capture():r.cancel(),l.trigger(n,e),h.cancel()},allowSelection:!0,end:function(e){l.trigger(s,e)}}),c=new m({element:l.element,container:l.container}),g=c.x,g.bind(E,function(){l.trigger(E)}),d=new f({dimensions:c,userEvents:r,movable:o,elastic:!0}),e.extend(l,{duration:a&&a.duration||1,movable:o,transition:h,userEvents:r,dimensions:c,dimension:g,pane:d}),this.bind([i,n,s,E],a)},size:function(){return{width:this.dimensions.x.getSize(),height:this.dimensions.y.getSize()}},total:function(){return this.dimension.getTotal()},offset:function(){return-this.movable.x},updateDimension:function(){this.dimension.update(!0)},refresh:function(){this.dimensions.refresh()},moveTo:function(e){this.movable.moveAxis("x",-e)},transitionTo:function(e,t,i){i?this.moveTo(-e):this.transition.moveTo({location:e,duration:this.duration,ease:t})}}),p.mobile.ui.ScrollViewElasticPane=a,o=p.Observable.extend({init:function(e,t){var i=this;p.Observable.fn.init.call(this),i.element=e,i.pane=t,i._getPages(),this.page=0,this.pageSize=1},scrollTo:function(e,t){this.page=e,this.pane.transitionTo(-e*this.pane.size().width,u.easeOutExpo,t)},paneMoved:function(e,t,i,n){var s,a,o=this,h=o.pane,r=h.size().width*o.pageSize,c=T,p=t?u.easeOutBack:u.easeOutExpo;e===A?c=x:e===q&&(c=z),a=c(h.offset()/r),s=S(o.minSnap,C(-a*r,o.maxSnap)),a!=o.page&&i&&i({currentPage:o.page,nextPage:a})&&(s=-o.page*h.size().width),h.transitionTo(s,p,n)},updatePage:function(){var e=this.pane,t=T(e.offset()/e.size().width);return t!=this.page?(this.page=t,!0):!1},forcePageUpdate:function(){return this.updatePage()},resizeTo:function(e){var t=this.pane,i=e.width;this.pageElements.width(i),t.updateDimension(),this._paged||(this.page=z(t.offset()/i)),this.scrollTo(this.page,!0),this.pageCount=x(t.total()/i),this.minSnap=-(this.pageCount-1)*i,this.maxSnap=0},_getPages:function(){this.pageElements=this.element.find("[data-role=page]"),this._paged=this.pageElements.length>0}}),p.mobile.ui.ScrollViewContent=o,h=p.Observable.extend({init:function(e,t,i){var n=this;p.Observable.fn.init.call(this),n.element=e,n.pane=t,n.options=i,n._templates(),n.page=0,n.pages=[],n._initPages(),n.resizeTo(n.pane.size()),n.pane.dimension.forceEnabled()},setDataSource:function(e){this.dataSource=v.create(e),this._buffer(),this._pendingPageRefresh=!1,this._pendingWidgetRefresh=!1},_viewShow:function(){var e=this;e._pendingWidgetRefresh&&(setTimeout(function(){e._resetPages()},0),e._pendingWidgetRefresh=!1)},_buffer:function(){var e=this.options.itemsPerPage;this.buffer&&this.buffer.destroy(),this.buffer=e>1?new P(this.dataSource,e):new w(this.dataSource,3*e),this._resizeProxy=l(this,"_onResize"),this._resetProxy=l(this,"_onReset"),this._endReachedProxy=l(this,"_onEndReached"),this.buffer.bind({resize:this._resizeProxy,reset:this._resetProxy,endreached:this._endReachedProxy})},_templates:function(){var e=this.options.template,t=this.options.emptyTemplate,i={},n={};typeof e===k&&(i.template=e,e="#=this.template(data)#"),this.template=l(p.template(e),i),typeof t===k&&(n.emptyTemplate=t,t="#=this.emptyTemplate(data)#"),this.emptyTemplate=l(p.template(t),n)},_initPages:function(){var e,t,i=this.pages,n=this.element;for(t=0;B>t;t++)e=new r(n),i.push(e);this.pane.updateDimension()},resizeTo:function(e){var t,i,n=this.pages,s=this.pane;for(t=0;t<n.length;t++)n[t].setWidth(e.width);"auto"===this.options.contentHeight?this.element.css("height",this.pages[1].element.height()):"100%"===this.options.contentHeight&&(i=this.element.parent().height(),this.element.css("height",i),n[0].element.css("height",i),n[1].element.css("height",i),n[2].element.css("height",i)),s.updateDimension(),this._repositionPages(),this.width=e.width},scrollTo:function(e){var t,i=this.buffer;i.syncDataSource(),t=i.at(e),t&&(this._updatePagesContent(e),this.page=e)},paneMoved:function(e,t,i,n){var s=this,a=s.pane,o=a.size().width,h=a.offset(),r=Math.abs(h)>=o/3,c=t?p.effects.Transition.easeOutBack:p.effects.Transition.easeOutExpo,g=s.page+2>s.buffer.total(),d=0;e===q?0!==s.page&&(d=-1):e!==A||g?h>0&&r&&!g?d=1:0>h&&r&&0!==s.page&&(d=-1):d=1,i&&i()&&(d=0),0===d?s._cancelMove(c,n):-1===d?s._moveBackward(n):1===d&&s._moveForward(n)},updatePage:function(){var e=this.pages;return 0===this.pane.offset()?!1:(this.pane.offset()>0?(e.push(this.pages.shift()),this.page++,this.setPageContent(e[2],this.page+1)):(e.unshift(this.pages.pop()),this.page--,this.setPageContent(e[0],this.page-1)),this._repositionPages(),this._resetMovable(),!0)},forcePageUpdate:function(){var e=this.pane.offset(),t=3*this.pane.size().width/4;return y(e)>t?this.updatePage():!1},_resetMovable:function(){this.pane.moveTo(0)},_moveForward:function(e){this.pane.transitionTo(-this.width,p.effects.Transition.easeOutExpo,e)},_moveBackward:function(e){this.pane.transitionTo(this.width,p.effects.Transition.easeOutExpo,e)},_cancelMove:function(e,t){this.pane.transitionTo(0,e,t)},_resetPages:function(){this._updatePagesContent(),this._repositionPages(),this.page=0,this.trigger("reset")},_onResize:function(){var e=this.pages[2],t=this.page+1;this._pendingPageRefresh&&(this.setPageContent(e,t),this._pendingPageRefresh=!1)},_onReset:function(){this.pageCount=x(this.dataSource.total()/this.options.itemsPerPage),this.element.is(":visible")?this._resetPages():this._widgetNeedsRefresh=!0},_onEndReached:function(){this._pendingPageRefresh=!0},_repositionPages:function(){var e=this.pages;e[0].position(M),e[1].position(H),e[2].position(U)},_updatePagesContent:function(e){var t=this.pages,i=e||0;this.setPageContent(t[0],i-1),this.setPageContent(t[1],i),this.setPageContent(t[2],i+1)},setPageContent:function(t,i){var n=this.buffer,s=this.template,a=this.emptyTemplate,o=null;i>=0&&(o=n.at(i),e.isArray(o)&&!o.length&&(o=null)),o?t.content(s(o)):t.content(a({})),p.mobile.init(t.element),this.trigger(D,{item:t.element,data:o,ns:p.mobile.ui})}}),p.mobile.ui.VirtualScrollViewContent=h,r=p.Class.extend({init:function(t){this.element=e("<div class='"+W+"'></div>"),this.width=t.width(),this.element.width(this.width),t.append(this.element)},content:function(e){this.element.html(e)},position:function(e){this.element.css("transform","translate3d("+this.width*e+"px, 0, 0)")},setWidth:function(e){this.width=e,this.element.width(e)}}),p.mobile.ui.VirtualPage=r,c=_.extend({init:function(e,t){var i,n=this;_.fn.init.call(n,e,t),t=n.options,e=n.element,p.stripWhitespace(e[0]),e.wrapInner("<div/>").addClass("km-scrollview"),this.options.enablePager&&(this.pager=new F(this)),n.inner=e.children().first(),n.page=0,n.inner.css("height",t.contentHeight),n.container().bind("show",l(this,"viewShow")).bind("init",l(this,"viewInit")),n.pane=new a(n.inner,{duration:this.options.duration,transitionEnd:l(this,"_transitionEnd"),dragStart:l(this,"_dragStart"),dragEnd:l(this,"_dragEnd"),change:l(this,O)}),n.bind("resize",function(){n.pane.refresh()}),n.page=t.page,i=0===this.inner.children().length,n._content=i?new h(n.inner,n.pane,t):new o(n.inner,n.pane),n._content.page=n.page,n._content.bind("reset",function(){n._syncWithContent()}),n._content.bind(D,function(e){n.trigger(D,e)}),n.setDataSource(t.dataSource)},options:{name:"ScrollView",page:0,duration:300,velocityThreshold:.8,contentHeight:"auto",pageSize:1,itemsPerPage:1,bounceVelocityThreshold:1.6,enablePager:!0,autoBind:!0,template:"",emptyTemplate:""},events:[R,E,O],destroy:function(){_.fn.destroy.call(this),p.destroy(this.element)},viewInit:function(){this.options.autoBind&&this._content.scrollTo(this._content.page,!0)},viewShow:function(){this.pane.refresh()},refresh:function(){var e=this._content;e.resizeTo(this.pane.size()),this.page=e.page,this.trigger(O,{pageCount:e.pageCount,page:e.page})},content:function(e){this.element.children().first().html(e),this._content._getPages(),this.pane.refresh()},scrollTo:function(e,t){this._content.scrollTo(e,t),this._syncWithContent()},setDataSource:function(e){if(this._content instanceof h){var t=!e;this.dataSource=v.create(e),this._content.setDataSource(this.dataSource),this.options.autoBind&&!t&&this.dataSource.fetch()}},items:function(){return this.element.find("."+W)},_syncWithContent:function(){var e,i,n=this._content.pages,s=this._content.buffer;this.page=this._content.page,e=s?s.at(this.page):t,e instanceof Array||(e=[e]),i=n?n[1].element:t,this.trigger(E,{page:this.page,element:i,data:e})},_dragStart:function(){this._content.forcePageUpdate()&&this._syncWithContent()},_dragEnd:function(e){var t=this,i=e.x.velocity,n=this.options.velocityThreshold,s=I,a=y(i)>this.options.bounceVelocityThreshold;i>n?s=q:-n>i&&(s=A),this._content.paneMoved(s,a,function(e){return t.trigger(R,e)})},_transitionEnd:function(){this._content.updatePage()&&this._syncWithContent()}}),d.plugin(c)}(window.kendo.jQuery)})}("function"==typeof define&&define.amd?define:function(e,t){return t()});
//@ sourceMappingURL=kendo.mobile.scrollview.min.js.map